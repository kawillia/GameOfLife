<!DOCTYPE html>
<html>
<head>
    <title>SignalR Game of Life</title>
</head>
<body>
    <script src="/Scripts/jquery-1.8.2.min.js" ></script>
    <script src="/Scripts/jquery.signalR-1.0.0.js"></script>
    <script src="/signalr/hubs"></script> 
    <script type="text/javascript">
        $(function () {
            var gameOfLife = $.connection.gameOfLifeHub;
            gameOfLife.client.updateLivingCells = function (livingCells) {
                renderLivingCells(livingCells);
            };

            $.connection.hub.start().done(function () {
                gameOfLife.server.getLivingCells().done(function (livingCells) {
                    renderLivingCells(livingCells);
                });
            });

            function renderLivingCells(livingCells) {
                var canvas = document.getElementById('gridCanvas');
                var context = canvas.getContext('2d');
                context.clearRect(0, 0, canvas.width, canvas.height);

                $.each(livingCells, function (i) {
                    context.beginPath();
                    context.rect(this.X * 10, this.Y * 10, 10, 10);
                    context.fillStyle = 'black';
                    context.fill();
                    context.lineWidth = 1;
                    context.strokeStyle = 'black';
                    context.stroke();
                });
            }
        });
    </script>
    <canvas id="gridCanvas" width="500" height="500"></canvas>
</body>
</html>